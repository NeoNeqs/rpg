[gd_scene load_steps=38 format=3 uid="uid://iivb1yj1wg2a"]

[ext_resource type="Script" uid="uid://dbo1dwrnn5qru" path="res://world/character/PlayerCharacter.cs" id="1_pdabv"]
[ext_resource type="PackedScene" uid="uid://bpnsv045afu5t" path="res://assets/models/character/Pirate_Male.gltf" id="2_1jngo"]
[ext_resource type="Script" uid="uid://do8hg8vd5v8ui" path="res://scripts/inventory/GizmoStack.cs" id="2_c4acw"]
[ext_resource type="Script" uid="uid://dpuryjvuxj7fx" path="res://world/character/PlayerCharacterBody.cs" id="2_fn1hb"]
[ext_resource type="Resource" uid="uid://cy52kgcuvj2pc" path="res://character_inventory.tres" id="2_m0gsu"]
[ext_resource type="Script" uid="uid://b2yjmi2mufyqh" path="res://scripts/inventory/Inventory.cs" id="3_vqai4"]
[ext_resource type="Script" uid="uid://b6ma5srt1o11b" path="res://scripts/combat/Stats.cs" id="4_pdabv"]
[ext_resource type="Script" uid="uid://bk27a6avfmj1x" path="res://scripts/inventory/components/SpellComponent.cs" id="5_qdl7p"]
[ext_resource type="Script" uid="uid://dtyyu3w8h6fnp" path="res://scripts/inventory/components/GizmoComponent.cs" id="6_ggcj5"]
[ext_resource type="Script" uid="uid://dbsutjhc4nqxg" path="res://scripts/combat/CombatManager.cs" id="6_lbca7"]
[ext_resource type="Resource" uid="uid://dfebkmuinemk8" path="res://resources/spells/fire_ball.tres" id="7_g02qr"]
[ext_resource type="Resource" uid="uid://8u7wfnel2xpp" path="res://resources/spells/fire_rain.tres" id="8_xy7j0"]
[ext_resource type="Script" uid="uid://4m7emmkgdioy" path="res://scripts/combat/StatCurves.cs" id="10_f1wg7"]
[ext_resource type="Script" uid="uid://bp1c67o5mclqa" path="res://scripts/combat/CombatSystem.cs" id="11_m0gsu"]
[ext_resource type="Texture2D" uid="uid://cg74nveil4vpb" path="res://icon.svg" id="12_d882m"]
[ext_resource type="Script" uid="uid://blcc2ydrwger3" path="res://world/character/AoeDecal.cs" id="15_d882m"]
[ext_resource type="Script" uid="uid://b2coni50v0uls" path="res://world/character/CameraController.cs" id="15_ggcj5"]
[ext_resource type="Script" uid="uid://bk7iy0hrav8gb" path="res://world/character/MovementController.cs" id="15_qdl7p"]
[ext_resource type="Script" uid="uid://bl5tc275grlvk" path="res://world/character/HotbarManager.cs" id="19_7k511"]

[sub_resource type="Resource" id="Resource_fn1hb"]
script = ExtResource("3_vqai4")
Gizmos = Array[ExtResource("2_c4acw")]([])
Columns = 0
AllowedComponents = []
Flags = 0
metadata/_custom_type_script = "uid://b2yjmi2mufyqh"

[sub_resource type="Resource" id="Resource_yux1m"]
script = ExtResource("5_qdl7p")
Effects = []
CooldownSeconds = 0
metadata/_custom_type_script = "uid://bk27a6avfmj1x"

[sub_resource type="Resource" id="Resource_d882m"]
script = ExtResource("2_c4acw")
Gizmo = ExtResource("7_g02qr")
Quantity = 1
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_7k511"]
script = ExtResource("2_c4acw")
Gizmo = ExtResource("8_xy7j0")
Quantity = 1
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_g02qr"]
script = ExtResource("2_c4acw")
Gizmo = ExtResource("8_xy7j0")
Quantity = 1
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_xy7j0"]
script = ExtResource("2_c4acw")
Quantity = 0
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_r2p0t"]
script = ExtResource("2_c4acw")
Quantity = 0
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_m6k5q"]
script = ExtResource("2_c4acw")
Quantity = 0
AllowedComponents = Array[ExtResource("6_ggcj5")]([])

[sub_resource type="Resource" id="Resource_s02qt"]
script = ExtResource("3_vqai4")
Gizmos = Array[ExtResource("2_c4acw")]([SubResource("Resource_d882m"), SubResource("Resource_7k511"), SubResource("Resource_g02qr"), SubResource("Resource_xy7j0"), SubResource("Resource_r2p0t"), SubResource("Resource_m6k5q")])
Columns = 0
AllowedComponents = Array[Object]([SubResource("Resource_yux1m")])
Flags = 1
metadata/_custom_type_script = "uid://b2yjmi2mufyqh"

[sub_resource type="Resource" id="Resource_f1wg7"]
script = ExtResource("4_pdabv")
_IntegerStats = Dictionary[String, int]({})
_DecimalStats = Dictionary[String, float]({})
metadata/_custom_type_script = "uid://b6ma5srt1o11b"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_1jngo"]
radius = 0.164166
height = 0.8

[sub_resource type="GDScript" id="GDScript_qdl7p"]
script/source = "extends SpringArm3D

# TODO: make the model slowly more transparent as the spring arm gets closer to the model.
func _physics_process(_delta: float) -> void:
	get_parent().get_parent().get_child(1).visible = get_hit_length() > 0.6
"

[sub_resource type="Curve" id="Curve_qdl7p"]

[sub_resource type="Curve" id="Curve_pdabv"]
_limits = [0.4, 1.0, 0.0, 3000.0]
_data = [Vector2(0, 1), 0.0, -0.000181341, 0, 1, Vector2(2229.32, 0.595732), -0.000181341, -4.71288e-05, 1, 0, Vector2(3000, 0.4), -0.000352398, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_ggcj5"]

[sub_resource type="Curve" id="Curve_yux1m"]

[sub_resource type="Resource" id="Resource_m0gsu"]
script = ExtResource("10_f1wg7")
ArmorReductionCurve = SubResource("Curve_pdabv")
ArmorPenetrationCurve = SubResource("Curve_qdl7p")
StrengthCurve = SubResource("Curve_yux1m")
StaminaCurve = SubResource("Curve_ggcj5")
metadata/_custom_type_script = "uid://4m7emmkgdioy"

[sub_resource type="Resource" id="Resource_vqai4"]
script = ExtResource("11_m0gsu")
StatCurves = SubResource("Resource_m0gsu")
metadata/_custom_type_script = "uid://bp1c67o5mclqa"

[node name="Character" type="Node3D" node_paths=PackedStringArray("CombatManager")]
script = ExtResource("1_pdabv")
Inventory = ExtResource("2_m0gsu")
CombatManager = NodePath("CombatManager")
Armory = SubResource("Resource_fn1hb")
SpellBook = SubResource("Resource_s02qt")
BaseStats = SubResource("Resource_f1wg7")

[node name="Body" type="CharacterBody3D" parent="."]
collision_layer = 2
script = ExtResource("2_fn1hb")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Body"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.380275, -0.04477)
shape = SubResource("CapsuleShape3D_1jngo")

[node name="Model" type="Node3D" parent="Body"]

[node name="Pirate_Male" parent="Body/Model" instance=ExtResource("2_1jngo")]
transform = Transform3D(-0.2, 0, -3.01992e-08, 0, 0.2, 0, 3.01992e-08, 0, -0.2, 0, 0, 0)

[node name="Pivot" type="Node3D" parent="Body"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.426638, 0)

[node name="Arm" type="SpringArm3D" parent="Body/Pivot"]
spring_length = 5.0
script = SubResource("GDScript_qdl7p")

[node name="Camera3D" type="Camera3D" parent="Body/Pivot/Arm"]

[node name="MovementController" type="Node" parent="Body"]
script = ExtResource("15_qdl7p")
metadata/_custom_type_script = "uid://bk7iy0hrav8gb"

[node name="CameraController" type="Node" parent="Body"]
script = ExtResource("15_ggcj5")
metadata/_custom_type_script = "uid://b2coni50v0uls"

[node name="CombatManager" type="Node" parent="."]
script = ExtResource("6_lbca7")
CombatSystem = SubResource("Resource_vqai4")
metadata/_custom_type_script = "uid://dbsutjhc4nqxg"

[node name="HotbarManager" type="Node" parent="."]
script = ExtResource("19_7k511")
metadata/_custom_type_script = "uid://bl5tc275grlvk"

[node name="AoeDecal" type="Decal" parent="HotbarManager" node_paths=PackedStringArray("_character")]
visible = false
size = Vector3(1, 1, 1)
texture_albedo = ExtResource("12_d882m")
distance_fade_begin = 0.0
distance_fade_length = 4198.35
cull_mask = 1
script = ExtResource("15_d882m")
_character = NodePath("../..")

[node name="RayCast3D" type="RayCast3D" parent="HotbarManager/AoeDecal"]
target_position = Vector3(0, -50, 0)
